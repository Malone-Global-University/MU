<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MGU – Nav Separation Test</title>

  <style>
    /* ---- Theme tokens ---- */
    :root{
      --bg: #0b1220;
      --card: #071428;
      --text: #e6eef8;
      --muted: #98a2b3;
      --accent: #58a6ff;
      --accent-hover: #377bb5;
      --shadow: 0 6px 18px rgba(3,3,12,.18);
    }
    .light{
      --bg:#f9f9f9; --card:#ffffff; --text:#111827; --muted:#6b7280;
      --accent:#0055cc; --accent-hover:#003f99; --shadow:0 6px 18px rgba(0,0,0,.08);
    }
    html{scroll-behavior:smooth}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--text);line-height:1.55}

    /* ---- Branding header (separate from nav) ---- */
    .site-header{
      padding:20px 16px;
      text-align:left;
      background:linear-gradient(180deg, rgba(255,255,255,.04), transparent);
    }
    .site-header-inner{display:flex;flex-direction:column;align-items:center;gap:10px}
    .site-logo{height:52px}
    .site-title{font-size:1.6rem;font-weight:700;letter-spacing:.2px}

    /* ---- NAV (separate module) ---- */
    .navbar{
      position:sticky; top:0; z-index:1000;
      background:var(--card); box-shadow:var(--shadow);
    }

    /* Always-visible top row with toggle + theme */
    .nav-bar{
      display:flex; align-items:center; justify-content:flex-end;
      gap:10px; padding:10px 14px; border-bottom:1px solid rgba(255,255,255,.06);
    }
    .nav-toggle{
      background:none; border:0; cursor:pointer; font-size:1.4rem;
      padding:6px 10px; border-radius:8px; color:var(--text);
    }
    .nav-toggle:focus{outline:2px solid var(--accent); outline-offset:2px}
    .theme-toggle-btn{
      background:transparent; border:1px solid rgba(255,255,255,.12);
      border-radius:10px; padding:6px 10px; cursor:pointer; color:var(--text);
    }
    .theme-toggle-btn:hover{border-color:var(--accent)}

    /* Collapsible panel (UL) */
    .nav-links{
      list-style:none; display:flex; gap:12px; align-items:center; justify-content:center;
      padding:10px 14px;
    }
    .nav-links a{
      display:block; padding:8px 12px; border-radius:8px; text-decoration:none;
      color:var(--text);
    }
    .nav-links a:hover{background:rgba(255,255,255,.06); color:var(--accent)}

    /* --- Mobile: make links slide DOWN; toggle always visible --- */
    @media (max-width: 900px){
      .nav-links{
        flex-direction:column; align-items:stretch;
        overflow:hidden; max-height:0;
        transition:max-height .28s ease;
        padding:0 14px; /* collapsed: no extra top padding */
      }
      .nav-links.open{
        padding:10px 14px;
        max-height:420px;  /* adjust if you add items */
      }
      .nav-links a{padding:12px 10px}
    }

    /* Demo content */
    .hero{padding:64px 20px;text-align:center;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:#dbefff}
    .hero h1{font-size:clamp(1.8rem,4vw,3rem);margin-bottom:8px}
    .section{padding:42px 20px;max-width:900px;margin:auto}
    footer{padding:24px 16px;text-align:center;background:var(--card);color:var(--muted)}
  </style>
</head>
<body>

  <!-- Branding only -->
  <header class="site-header" role="banner">
    <div class="site-header-inner">
      <a href="/index"><img src="/image/global/logo.png" alt="Malone Global University Logo" class="site-logo"></a>
      <h1 class="site-title">Malone Global University</h1>
    </div>
  </header>

  <!-- Navbar loads here -->
  <div id="navbar-slot" role="region" aria-label="Primary navigation"></div>

  <!-- Page content -->
  <section class="hero">
    <h1>Architects of a New Order</h1>
    <p>Clean separation of branding and navigation with a reusable, JS-loaded menu.</p>
  </section>
  <section class="section">
    <h2>Why this works</h2>
    <ul>
      <li><strong>Toggle outside the collapsible area</strong> ensures it’s always visible on mobile.</li>
      <li><strong>Sticky nav</strong> stacks under the branding without body padding hacks.</li>
      <li><strong>Single source of truth</strong>: edit <code>/component/html/navbar.html</code> once.</li>
    </ul>
  </section>

  <footer>© 2025 Malone Global University</footer>

  <script>
    (function(){
      const root = document.documentElement;

      // Load the external navbar, then wire up behavior.
      async function mountNavbar(){
        const slot = document.getElementById('navbar-slot');
        try{
          const res = await fetch('/component/html/navbar.html', { cache: 'no-store' });
          if(!res.ok) throw new Error('HTTP ' + res.status);
          slot.innerHTML = await res.text();
          initNavbar(slot);
        }catch(err){
          console.error('Navbar load failed:', err);
          // Fallback: minimal inline nav if fetch fails (keeps page usable)
          slot.innerHTML = `
            <nav class="navbar" aria-label="Main Navigation">
              <div class="nav-bar">
                <button id="nav-toggle" class="nav-toggle" aria-expanded="false" aria-controls="nav-links">☰</button>
                <button id="theme-toggle" class="theme-toggle-btn" aria-pressed="false">💻</button>
              </div>
              <ul class="nav-links" id="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/about">About</a></li>
              </ul>
            </nav>`;
          initNavbar(slot);
        }
      }

      function initNavbar(scope){
        const links = scope.querySelector('#nav-links');
        const toggle = scope.querySelector('#nav-toggle');
        const theme = scope.querySelector('#theme-toggle');

        // Guardrails
        if(!links || !toggle){ return; }

        // Toggle open/close (slide down on mobile)
        const setExpanded = (open) => {
          toggle.setAttribute('aria-expanded', String(open));
          links.classList.toggle('open', open);
        };
        toggle.addEventListener('click', () => setExpanded(!links.classList.contains('open')));
        toggle.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' '){
            e.preventDefault();
            setExpanded(!links.classList.contains('open'));
          }
        });

        // Click outside to close (mobile)
        document.addEventListener('click', (e)=>{
          const within = scope.contains(e.target);
          if(!within && links.classList.contains('open')) setExpanded(false);
        });

        // Close on escape
        document.addEventListener('keydown', (e)=>{
          if(e.key === 'Escape' && links.classList.contains('open')) setExpanded(false);
        });

        // Reset on resize up to desktop
        let lastW = window.innerWidth;
        window.addEventListener('resize', () => {
          const w = window.innerWidth;
          if(w >= 901 && lastW < 901){ setExpanded(false); }
          lastW = w;
        });

        // Theme toggle (persisted)
        if(theme){
          const apply = (mode) => {
            root.classList.remove('light','dark');
            if(mode !== 'system'){ root.classList.add(mode); }
            localStorage.setItem('theme-preference', mode);
            theme.setAttribute('aria-pressed', String(mode === 'dark'));
            theme.textContent = mode === 'light' ? '☀️' : mode === 'dark' ? '🌙' : '💻';
          };
          const saved = localStorage.getItem('theme-preference') || 'system';
          apply(saved);
          theme.addEventListener('click', ()=>{
            const current = localStorage.getItem('theme-preference') || 'system';
            const next = current === 'system' ? 'dark' : current === 'dark' ? 'light' : 'system';
            apply(next);
          });
          window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', ()=>{
            if((localStorage.getItem('theme-preference') || 'system') === 'system') apply('system');
          });
        }
      }

      document.addEventListener('DOMContentLoaded', mountNavbar);
    })();
  </script>
</body>
</html>