<nav class="mgu-navbar" aria-label="Main Navigation">
  <button class="nav-toggle" id="nav-toggle" aria-label="Toggle menu"> <!-- 1st match -->
    <span></span><span></span><span></span>
  </button>

  <div class="nav-menu" id="nav-menu">  <!-- 2nd match in html -->
    <ul class="nav-main">
      <li><a href="/homepage">Home</a></li>
      <li><a href="/about">About</a></li>
      <li><a href="/mission">Mission</a></li>
      <li><a href="/community/resources">Community</a></li>
      <li><a href="/library/directory">Library</a></li>
      <li><a href="/department/directory">Department</a></li>
      <li><a href="/community/devblog/update">DevBlog</a></li>
      <li><a href="/contact">Contact</a></li>
    </ul>

    <div class="nav-toggle">  
      <div class="theme-toggle-wrap">
        <button id="theme-toggle" class="theme-toggle-btn" aria-pressed="false">ðŸ’»</button> <!-- 3rd match in html -->
      </div>
    </div>
  </div>
</nav>


document.addEventListener("DOMContentLoaded", () => {
  fetch("/component/partial/navbar/site-navbar.html")
    .then(res => res.text())
    .then(html => {
      const container = document.getElementById("navbar-placeholder"); <!-- this exists in full html -->
      container.innerHTML = html;

      // Grab injected elements
      const navToggle = document.getElementById("nav-toggle"); <!-- 1st match -->
      const navLinks = document.getElementById("nav-menu"); <!-- 2nd match -->
      const themeToggle = document.getElementById("theme-toggle"); <!-- 3rd match -->
      const root = document.documentElement;

      // Nav toggle
      navToggle.addEventListener("click", () => navLinks.classList.toggle("show"));

      // Theme toggle with localStorage
      const saved = localStorage.getItem("theme-preference");
      if (saved) setTheme(saved);
      else setTheme("system");

      themeToggle.addEventListener("click", () => {
        const current = localStorage.getItem("theme-preference") || "system";
        const next = current === "system" ? "dark" :
                     current === "dark" ? "light" : "system";
        setTheme(next);
      });

      function setTheme(mode) {
        root.classList.remove("light", "dark");
        if (mode === "light") root.classList.add("light");
        else if (mode === "dark") root.classList.add("dark");
        localStorage.setItem("theme-preference", mode);
        themeToggle.textContent = mode === "light" ? "â˜€ï¸" : mode === "dark" ? "ðŸŒ™" : "ðŸ’»";
        themeToggle.setAttribute("aria-pressed", mode === "dark");
      }

      window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
        if(localStorage.getItem('theme-preference') === 'system') setTheme('system');
      });
    })
    .catch(err => console.error("Navbar load failed:", err));
});