How do I set powershell to run from c:/mgu at start instead of c/users/joseph ?
ChatGPT said:

You want your PowerShell session to start in C:\mgu instead of the default C:\Users\joseph.

There are a few ways to do this, depending on whether you want it permanent or temporary:

üîπ One-time Change (per session)

When you open PowerShell, run:

Set-Location C:\mgu


or the shorter alias:

cd C:\mgu

üîπ Permanent Change (always start in C:\mgu)

You can set the default startup location in your PowerShell profile script:

Check if you have a PowerShell profile file:

Test-Path $PROFILE


If it returns False, create one:

New-Item -Path $PROFILE -ItemType File -Force


Open the profile in Notepad:

notepad $PROFILE


Add this line at the bottom:

Set-Location C:\mgu


Save and close. Next time you open PowerShell, it will start in C:\mgu.

üîπ Windows Terminal (if you're using it)

If you open PowerShell via Windows Terminal:

Open Windows Terminal.

Click the dropdown ‚ñæ ‚Üí Settings.

Under Profiles ‚Üí PowerShell, scroll to "Starting directory".

Set it to:

C:\mgu


Save.

Now PowerShell in Windows Terminal will always start in C:\mgu.

üëâ Do you want this change only in Windows Terminal, or also when you open the old PowerShell.exe separately?

You said:
False
PS C:\Users\Joseph> New-Item -Path $PROFILE -ItemType File -Force
New-Item : Could not find file 'C:\Users\Joseph\OneDrive\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
At line:1 char:1
+ New-Item -Path $PROFILE -ItemType File -Force
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (C:\Users\Joseph...ell_profile.ps1:String) [New-Item], FileNotFoundException
    + FullyQualifiedErrorId : NewItemIOError,Microsoft.PowerShell.Commands.NewItemCommand
ChatGPT said:

Got it üëç ‚Äî the error means the folder path for your PowerShell profile doesn‚Äôt exist yet, so PowerShell can‚Äôt create the file directly.

We just need to make the folders first, then the profile file.

Run these steps in order:

Make the folder path:

New-Item -Path (Split-Path $PROFILE) -ItemType Directory -Force


Now create the profile file:

New-Item -Path $PROFILE -ItemType File -Force


Open the profile in Notepad:

notepad $PROFILE


Add this line inside:

Set-Location C:\mgu


Save and close. Next time you start PowerShell, it should automatically open in C:\mgu. ‚úÖ

Do you want me to also show you how to set this for both Windows PowerShell 5.x and the newer PowerShell 7 (pwsh) in case you‚Äôre using both?

You said:
PS C:\Users\Joseph> New-Item -Path (Split-Path $PROFILE) -ItemType Directory -Force


    Directory: C:\Users\Joseph\OneDrive\Documents


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         7/19/2025   7:24 PM                WindowsPowerShell


PS C:\Users\Joseph> New-Item -Path $PROFILE -ItemType File -Force
New-Item : Could not find file 'C:\Users\Joseph\OneDrive\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1'.
At line:1 char:1
+ New-Item -Path $PROFILE -ItemType File -Force
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : WriteError: (C:\Users\Joseph...ell_profile.ps1:String) [New-Item], FileNotFoundException
    + FullyQualifiedErrorId : NewItemIOError,Microsoft.PowerShell.Commands.NewItemCommand
ChatGPT said:

Ah, I see what‚Äôs happening üëç

You already created the WindowsPowerShell folder, but because OneDrive is syncing your Documents folder, sometimes PowerShell gets confused and throws that FileNotFoundException when creating files under a synced path.

Let‚Äôs bypass that issue by explicitly telling PowerShell to create the file with the full path instead of relying on $PROFILE.

Try this:

New-Item -Path "C:\Users\Joseph\OneDrive\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1" -ItemType File -Force


If that still errors, we can skip New-Item and just directly edit it with Notepad (Notepad will create it automatically):

notepad "C:\Users\Joseph\OneDrive\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1"


When Notepad opens, paste this line:

Set-Location C:\mgu


Save and close. ‚úÖ
Next time you start PowerShell, it should default to C:\mgu.

üëâ Question for you: are you mainly using Windows PowerShell 5.1 (the one that comes with Windows by default) or also PowerShell 7 (pwsh)? Because each has its own profile file location, and I can give you the path for both if you want them consistent.

You said:
Windows Terminal
Version: 1.22.12111.0
ChatGPT said:

Perfect ‚Äî thanks, that clears it up. üöÄ

Since you‚Äôre using Windows Terminal, the easiest and cleanest way is to set the starting directory inside Terminal settings, rather than messing with profile files.

Here‚Äôs how:

üîπ Set PowerShell startup folder in Windows Terminal

Open Windows Terminal.

Click the dropdown arrow ‚ñæ (next to the + tab) ‚Üí Settings.

On the left, under Profiles, select PowerShell (or Windows PowerShell if that‚Äôs the one you‚Äôre using).

Scroll down to "Starting directory".

Enter:

C:\mgu


Save and close.

Now, every time you open a PowerShell tab in Windows Terminal, it will start directly in C:\mgu. ‚úÖ

‚ö° Bonus: You can do this per-profile (so Command Prompt, PowerShell, Git Bash, etc., each can start in their own default folders).

Do you want me to also show you how to make a dedicated ‚ÄúMGU PowerShell‚Äù profile in Windows Terminal so you can just click it and always land in C:\mgu?

You said:
It does not list Powershell as a profile, only "defauly" and then custom profiles like MGU, git bash, vs code etc. Selecting MGU as "default" I can change starting directory to c:/mgu. Behavior is this: Opening terminal lands in  always starts as "Adminstrator: Powershell" profile. ctrl+shift+n opens new terminal window with "Adminstrator: MGU" profile. If opening new tabs on either it starts as MGU profile with c:/mgu as starting directory. No matter what setting I apply first terminal always is set to Admin Powershell with c:/users/joseph as starting directory.
ChatGPT said:

Ahhh, got it üëå ‚Äî thanks for describing the exact behavior. What‚Äôs happening is this:

When you launch Windows Terminal, it isn‚Äôt honoring your ‚Äúdefault profile‚Äù setting because you‚Äôre starting it as Administrator.

In that case, Windows Terminal uses the elevated startup profile (usually the stock Windows PowerShell one) instead of your custom "MGU" profile.

That‚Äôs why new tabs obey your MGU settings, but the first tab on launch doesn‚Äôt.

We can fix this in one of two ways:

‚úÖ Option 1: Force Windows Terminal (Admin) to open MGU profile

Open Windows Terminal settings (Ctrl+, or dropdown ‚ñæ ‚Üí Settings).

Go to the JSON settings file (bottom left: ‚ÄúOpen JSON file‚Äù).

Find the "startupActions" or "defaultProfile" section.
It might look like:

"defaultProfile": "{GUID-HERE}"


Replace that value with the GUID of your MGU profile.

To find it, scroll down to "profiles": { "list": [ ... ] } and locate your "name": "MGU".

Copy the "guid" value (looks like {xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx}).

Paste it into "defaultProfile".

Example:

"defaultProfile": "{f4d78b07-2ab3-4e16-bef4-123456789abc}"


Save the JSON file and restart Windows Terminal.

Now, even when launched as Administrator, it will start with the MGU profile in C:\mgu.

‚úÖ Option 2: Change your shortcut/taskbar pin

If you‚Äôre opening Terminal by right-clicking and selecting ‚ÄúRun as Administrator‚Äù (or because it‚Äôs pinned with admin mode forced), it will always fall back to the stock PowerShell profile.

Fix:

Unpin Windows Terminal from the taskbar/start menu.

Re-pin it, then edit the shortcut ‚Üí Properties ‚Üí Advanced ‚Üí Run as Administrator (if you still need admin).

Inside settings, make sure "defaultProfile" is set to your MGU.

‚úÖ Option 3: Explicitly launch MGU profile on startup

Instead of relying on "defaultProfile", you can tell Terminal to open directly into the MGU profile:

Open settings JSON again.

Add a "startupActions" line like this:

"startupActions": "new-tab -p MGU"


(Replace MGU with the exact "name" of your profile.)

This forces Terminal to start by opening your MGU tab first, regardless of admin/default profile quirks.

‚ö° So:

If you want all launches (admin or not) ‚Üí Option 1 (set "defaultProfile" to MGU‚Äôs GUID).

If you want a custom startup action (like always open MGU + Git Bash side-by-side) ‚Üí Option 3.

Do you want me to walk you through grabbing your MGU profile GUID from the JSON so we can lock it in as the real default?

You said:
{
    "$help": "https://aka.ms/terminal-documentation",
    "$schema": "https://aka.ms/terminal-profiles-schema",
    "actions": 
    [
        {
            "command": 
            {
                "action": "copy",
                "singleLine": false
            },
            "id": "User.copy.644BA8F2"
        },
        {
            "command": "paste",
            "id": "User.paste"
        },
        {
            "command": 
            {
                "action": "splitPane",
                "split": "auto",
                "splitMode": "duplicate"
            },
            "id": "User.splitPane.A6751878"
        },
        {
            "command": "find",
            "id": "User.find"
        }
    ],
    "alwaysShowNotificationIcon": true,
    "centerOnLaunch": true,
    "confirmCloseAllTabs": false,
    "copyFormatting": "all",
    "copyOnSelect": true,
    "defaultProfile": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",
    "keybindings": 
    [
        {
            "id": "User.copy.644BA8F2",
            "keys": "ctrl+c"
        },
        {
            "id": "User.find",
            "keys": "ctrl+shift+f"
        },
        {
            "id": "User.paste",
            "keys": "ctrl+v"
        },
        {
            "id": "User.splitPane.A6751878",
            "keys": "alt+shift+d"
        }
    ],
    "language": "en-US",
    "launchMode": "default",
    "newTabMenu": 
    [
        {
            "type": "remainingProfiles"
        }
    ],
    "profiles": 
    {
        "defaults": 
        {
            "adjustIndistinguishableColors": "always",
            "backgroundImage": "C:\\MGU\\image\\logo.png",
            "backgroundImageStretchMode": "uniform",
            "cursorShape": "vintage",
            "elevate": true,
            "experimental.retroTerminalEffect": false,
            "font": 
            {
                "weight": "normal"
            },
            "icon": "C:\\MGU\\image\\logo.png",
            "startingDirectory": "C:\\mgu",
            "tabTitle": "MGU TERMINAL"
        },
        "list": 
        [
            {
                "colorScheme": "IBM 5153",
                "commandline": "%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
                "experimental.rightClickContextMenu": true,
                "guid": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",
                "hidden": false,
                "icon": null,
                "name": "MRELLC TERMINAL",
                "startingDirectory": "C:\\mgu"
            },
            {
                "commandline": "%SystemRoot%\\System32\\cmd.exe",
                "guid": "{0caa0dad-35be-5f56-a8ff-afceeeaa6101}",
                "hidden": false,
                "name": "Command Prompt"
            },
            {
                "guid": "{b453ae62-4e3d-5e58-b989-0a998ec441b8}",
                "hidden": false,
                "name": "Azure Cloud Shell",
                "source": "Windows.Terminal.Azure"
            },
            {
                "guid": "{b36504c9-493c-51ec-b68e-4e0bb5978057}",
                "hidden": false,
                "name": "Developer Command Prompt for VS 2022",
                "source": "Windows.Terminal.VisualStudio"
            },
            {
                "guid": "{9a862999-20c1-5d0f-8eeb-c73956b436cf}",
                "hidden": false,
                "name": "Developer PowerShell for VS 2022",
                "source": "Windows.Terminal.VisualStudio"
            },
            {
                "guid": "{2ece5bfe-50ed-5f3a-ab87-5cd4baafed2b}",
                "hidden": false,
                "name": "Git Bash",
                "source": "Git"
            },
            {
                "guid": "{93e915cd-b9bb-5e58-80f2-0f5bb30359e8}",
                "hidden": false,
                "name": "Debian",
                "source": "Microsoft.WSL"
            },
            {
                "guid": "{0f400f01-4734-565b-a1fe-83cee5671a6d}",
                "hidden": true,
                "name": "Developer Command Prompt for VS 2019",
                "source": "Windows.Terminal.VisualStudio"
            },
            {
                "guid": "{06452706-d19c-59b3-9e68-94f92a2736b1}",
                "hidden": true,
                "name": "Developer PowerShell for VS 2019",
                "source": "Windows.Terminal.VisualStudio"
            }
        ]
    },
    "schemes": [],
    "showTabsInTitlebar": false,
    "theme": "dark",
    "themes": [],
    "useAcrylicInTabRow": true
}
ChatGPT said:

Nice ‚Äî thanks for pasting your settings.json üôå That explains exactly what‚Äôs happening.

Right now, your "defaultProfile" is set to:

"defaultProfile": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}"


and in your "profiles": { "list": [...] }, that same GUID ({61c54bbd-c2c6-5271-96e7-009a87ff44bf}) points to:

{
    "colorScheme": "IBM 5153",
    "commandline": "%SystemRoot%\\System32\\WindowsPowerShell\\v1.0\\powershell.exe",
    "experimental.rightClickContextMenu": true,
    "guid": "{61c54bbd-c2c6-5271-96e7-009a87ff44bf}",
    "hidden": false,
    "icon": null,
    "name": "MRELLC TERMINAL",
    "startingDirectory": "C:\\mgu"
}


So in theory, your default profile already is MRELLC TERMINAL, starting in C:\mgu. ‚úÖ

Why it still launches as "Administrator: Windows PowerShell" in C:\Users\Joseph

That means Windows Terminal is not actually starting with your JSON config, but is instead being launched via a different shortcut pinned in the Start Menu/Taskbar that forces the legacy ‚ÄúWindows PowerShell‚Äù profile.

This happens when:

Windows Terminal was pinned before you customized profiles, or

You have a shortcut with wt.exe -p "Windows PowerShell" in it, or

The ‚ÄúRun as Administrator‚Äù shortcut points directly at PowerShell instead of Terminal.

üîß Fix

Unpin Windows Terminal from your taskbar/start menu.

Right-click ‚Üí Unpin.

Search for Windows Terminal in the Start Menu.

Open it once normally (not right-click ‚Üí run as admin).

You should see it start as ‚ÄúMRELLC TERMINAL‚Äù in C:\mgu.

Now, right-click ‚Üí Pin to Taskbar again.

If you want it to always run as Administrator:

Right-click the pinned icon ‚Üí Properties ‚Üí Advanced‚Ä¶ ‚Üí check Run as administrator.

This will run Terminal itself as admin, but still load your "defaultProfile" (MRELLC TERMINAL).

‚ö° Alternative

If you want to force the very first tab to always be your MGU profile regardless of defaults, add this to the root of your JSON:

"startupActions": "new-tab -p \"MRELLC TERMINAL\""


That guarantees every new Terminal window (admin or not) opens the MRELLC profile in C:\mgu.

üëâ Do you want me to write out the exact settings.json snippet you should paste in (with "startupActions") so you can be 100% sure it always opens in C:\mgu?